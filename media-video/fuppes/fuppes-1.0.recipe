SUMMARY="Free UPnP A/V media server"
DESCRIPTION="FUPPES is a free, multiplatform UPnP A/V Media Server. \
FUPPES supports a wide range of UPnP MediaRenderers as well as on-the-fly \
transcoding of various audio, video and image formats. FUPPES also includes \
basic DLNA support."
HOMEPAGE="https://github.com/uvoelkel/fuppes/"
COPYRIGHT="2007-2009 Ulrich VÃ¶lkel"
LICENSE="GNU GPL v2"
REVISION="1"
srcGitRev="1c9b4cc78e2dd3f424face74d06ac3918ea38180"
SOURCE_URI="https://github.com/uvoelkel/fuppes/archive/$srcGitRev.tar.gz"
CHECKSUM_SHA256="b30388408591ebdd71e3b9334d9efafa5fb53330e2938127b995c0f4330d2470"
SOURCE_DIR="fuppes-$srcGitRev"
PATCHES="fuppes-$portVersion.patchset"

ARCHITECTURES="!x86_gcc2 x86 x86_64"
SECONDARY_ARCHITECTURES="x86"

GLOBAL_WRITABLE_FILES="
	var/lib/fuppes directory keep-old
	"

PROVIDES="
	fuppes$secondaryArchSuffix = $portVersion
	cmd:fuppes$secondaryArchSuffix = $portVersion
	cmd:fuppesd$secondaryArchSuffix = $portVersion
	lib:libfuppes$secondaryArchSuffix = $portVersion
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libavcodec$secondaryArchSuffix
	lib:libavformat$secondaryArchSuffix
	lib:libavutil$secondaryArchSuffix
	lib:libcurl$secondaryArchSuffix
	lib:libev$secondaryArchSuffix
	lib:libevent$secondaryArchSuffix
	lib:libexiv2$secondaryArchSuffix
	lib:libFLAC$secondaryArchSuffix
	lib:libiconv$secondaryArchSuffix
	lib:libMagickWand_6.Q16$secondaryArchSuffix
	lib:libmpcdec$secondaryArchSuffix
	lib:libmp4v2$secondaryArchSuffix
	lib:libopus$secondaryArchSuffix
	lib:libpcre$secondaryArchSuffix
	lib:libsqlite3$secondaryArchSuffix
	lib:libtag$secondaryArchSuffix
	lib:libuuid$secondaryArchSuffix
	lib:libvorbis$secondaryArchSuffix
	lib:libxml2$secondaryArchSuffix
	"

PROVIDES_devel="
	fuppes${secondaryArchSuffix}_devel = $portVersion
	devel:fuppes$secondaryArchSuffix = $portVersion
	"
REQUIRES_devel="
	fuppes$secondaryArchSuffix == $portVersion
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libavcodec$secondaryArchSuffix
	devel:libavformat$secondaryArchSuffix
	devel:libavutil$secondaryArchSuffix
	devel:libcurl$secondaryArchSuffix
	devel:libev$secondaryArchSuffix
	devel:libevent$secondaryArchSuffix
	devel:libexiv2$secondaryArchSuffix
	devel:libFLAC$secondaryArchSuffix
	devel:libiconv$secondaryArchSuffix
	devel:libMagickWand_6.Q16$secondaryArchSuffix
	devel:libmpcdec$secondaryArchSuffix
	devel:libmp4v2$secondaryArchSuffix
	devel:libopus$secondaryArchSuffix
	devel:libpcre$secondaryArchSuffix
	devel:libsqlite3$secondaryArchSuffix
	devel:libtag$secondaryArchSuffix
	devel:libuuid$secondaryArchSuffix
	devel:libvorbis$secondaryArchSuffix
	devel:libxml2$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:aclocal
	cmd:autoreconf
	cmd:gcc$secondaryArchSuffix
	cmd:gettext
	cmd:git
	cmd:libtoolize$secondaryArchSuffix
	cmd:make
	cmd:pkg_config$secondaryArchSuffix
	"

BUILD()
{
	export CPPFLAGS="-Wno-deprecated"

	autoreconf -vfi
	runConfigure ./configure
	make $jobArgs
}

INSTALL()
{
	make install
}
